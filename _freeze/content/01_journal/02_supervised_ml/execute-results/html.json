{
  "hash": "c8cd4215d806cc735d2a79ff05c3da34",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"02 Supervised ML\"\ndate: \"2024-06-22\"\noutput:\n  html_document:\n    toc: true\n    toc_float: true\n    df_print: paged\n    collapsed: false\n    number_sections: true\n    toc_depth: 3\n    #code_folding: hide\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidymodels)\nlibrary(broom.mixed)\nlibrary(xgboost)\nlibrary(tidyverse)\nlibrary(parsnip)\nlibrary(recipes)\nlibrary(rsample)\nlibrary(yardstick)\nlibrary(rpart.plot)\nlibrary(modeldata)\n# Data exploration\nbike_data_tbl <- readRDS(\"C:/Users/ranja/Documents/GitHub/ss24-bdml-ranjan/Business Decisions with Machine Learning/Machine Learning/data/Business Decisions with Machine Learning/bike_orderlines.rds\")\nmodel_sales_tbl <- bike_data_tbl %>%\n  select(total_price, model, category_2, frame_material) %>%\n  \n  group_by(model, category_2, frame_material) %>%\n  summarise(total_sales = sum(total_price)) %>%\n  ungroup() %>%\n  \n  arrange(desc(total_sales))\nmodel_sales_tbl %>%\n  mutate(category_2 = as_factor(category_2) %>% \n           fct_reorder(total_sales, .fun = max) %>% \n           fct_rev()) %>%\n  \n  ggplot(aes(frame_material, total_sales)) +\n  geom_violin() +\n  geom_jitter(width = 0.1, alpha = 0.5, color = \"#2c3e50\") +\n  #coord_flip() +\n  facet_wrap(~ category_2) +\n  scale_y_continuous(labels = scales::dollar_format(scale = 1e-6, suffix = \"M\", accuracy = 0.1)) +\n  tidyquant::theme_tq() +\n  labs(\n    title = \"Total Sales for Each Model\",\n    x = \"Frame Material\", y = \"Revenue\"\n  )\n```\n\n::: {.cell-output-display}\n![](02_supervised_ml_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nbike_features_tbl <- readRDS(\"C:/Users/ranja/Documents/GitHub/ss24-bdml-ranjan/Business Decisions with Machine Learning/Machine Learning/data/Business Decisions with Machine Learning/bike_features_tbl.rds\")\nbike_features_tbl <- bike_features_tbl %>% \n  select(frame_material:gender, `Rear Derailleur`, `Shift Lever`) %>% \n  mutate(\n    `shimano dura-ace`        = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano dura-ace \") %>% as.numeric(),\n    `shimano ultegra`         = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano ultegra \") %>% as.numeric(),\n    `shimano 105`             = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano 105 \") %>% as.numeric(),\n    `shimano tiagra`          = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano tiagra \") %>% as.numeric(),\n    `Shimano sora`            = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano sora\") %>% as.numeric(),\n    `shimano deore`           = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano deore(?! xt)\") %>% as.numeric(),\n    `shimano slx`             = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano slx\") %>% as.numeric(),\n    `shimano grx`             = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano grx\") %>% as.numeric(),\n    `Shimano xt`              = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano deore xt |shimano xt \") %>% as.numeric(),\n    `Shimano xtr`             = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano xtr\") %>% as.numeric(),\n    `Shimano saint`           = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano saint\") %>% as.numeric(),\n    `SRAM red`                = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram red\") %>% as.numeric(),\n    `SRAM force`              = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram force\") %>% as.numeric(),\n    `SRAM rival`              = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram rival\") %>% as.numeric(),\n    `SRAM apex`               = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram apex\") %>% as.numeric(),\n    `SRAM xx1`                = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram xx1\") %>% as.numeric(),\n    `SRAM x01`                = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram x01|sram xo1\") %>% as.numeric(),\n    `SRAM gx`                 = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram gx\") %>% as.numeric(),\n    `SRAM nx`                 = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram nx\") %>% as.numeric(),\n    `SRAM sx`                 = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram sx\") %>% as.numeric(),\n    `SRAM sx`                 = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram sx\") %>% as.numeric(),\n    `Campagnolo potenza`      = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"campagnolo potenza\") %>% as.numeric(),\n    `Campagnolo super record` = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"campagnolo super record\") %>% as.numeric(),\n    `shimano nexus`           = `Shift Lever`     %>% str_to_lower() %>% str_detect(\"shimano nexus\") %>% as.numeric(),\n    `shimano alfine`          = `Shift Lever`     %>% str_to_lower() %>% str_detect(\"shimano alfine\") %>% as.numeric()\n  ) %>%  \n  select(-c(`Rear Derailleur`, `Shift Lever`)) %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) \nbike_features_tbl <- bike_features_tbl %>% \n  mutate(id = row_number()) %>% \n  mutate(frame_material = factor(frame_material)) %>%\n  select(id, everything()) \nbike_features_tbl %>% distinct(category_2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"category_2\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"Race\"},{\"1\":\"Endurance\"},{\"1\":\"E-Road\"},{\"1\":\"Cyclocross\"},{\"1\":\"Triathlon Bike\"},{\"1\":\"Fat Bikes\"},{\"1\":\"Cross-Country\"},{\"1\":\"Adventure\"},{\"1\":\"All-Road\"},{\"1\":\"E-Gravel\"},{\"1\":\"Trail\"},{\"1\":\"E-Mountain\"},{\"1\":\"Downhill\"},{\"1\":\"Dirt Jump\"},{\"1\":\"Enduro\"},{\"1\":\"E-City\"},{\"1\":\"E-Trekking\"},{\"1\":\"E-Fitness\"},{\"1\":\"City\"},{\"1\":\"Touring\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nsplit_obj <- rsample::initial_split(bike_features_tbl, prop   = 0.80, \n                                    strata = \"category_2\")\nsplit_obj %>% training() %>% distinct(category_2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"category_2\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"Race\"},{\"1\":\"Endurance\"},{\"1\":\"Cyclocross\"},{\"1\":\"Triathlon Bike\"},{\"1\":\"Fat Bikes\"},{\"1\":\"Cross-Country\"},{\"1\":\"All-Road\"},{\"1\":\"E-Gravel\"},{\"1\":\"E-Mountain\"},{\"1\":\"Downhill\"},{\"1\":\"Dirt Jump\"},{\"1\":\"Enduro\"},{\"1\":\"E-City\"},{\"1\":\"E-Trekking\"},{\"1\":\"E-Fitness\"},{\"1\":\"City\"},{\"1\":\"Touring\"},{\"1\":\"E-Road\"},{\"1\":\"Adventure\"},{\"1\":\"Trail\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nsplit_obj %>% testing() %>% distinct(category_2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"category_2\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"Race\"},{\"1\":\"Endurance\"},{\"1\":\"Cyclocross\"},{\"1\":\"Triathlon Bike\"},{\"1\":\"Fat Bikes\"},{\"1\":\"Cross-Country\"},{\"1\":\"All-Road\"},{\"1\":\"E-Gravel\"},{\"1\":\"Trail\"},{\"1\":\"E-Mountain\"},{\"1\":\"Enduro\"},{\"1\":\"E-Trekking\"},{\"1\":\"E-City\"},{\"1\":\"City\"},{\"1\":\"Touring\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ntrain_tbl <- training(split_obj)\ntest_tbl  <- testing(split_obj)\ntrain_data <- train_tbl %>% set_names(str_replace_all(names(train_tbl), \" |-\", \"_\"))\ntest_data  <- test_tbl  %>% set_names(str_replace_all(names(test_tbl),  \" |-\", \"_\"))\n# recipe\nbike_rec <- \n  recipe(frame_material ~ ., data = train_data) %>% \n  step_dummy(all_nominal(), -all_outcomes()) %>% \n  step_zv(all_predictors()) \nd <- summary(bike_rec)\nlr_mod <- \n  logistic_reg() %>% \n  set_engine(\"glm\")\nlr_mod\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Logistic Regression Model Specification (classification)\n#> \n#> Computational engine: glm\n```\n\n\n:::\n\n```{.r .cell-code}\nbike_wflow <- \n  workflow() %>% \n  add_model(lr_mod) %>% \n  add_recipe(bike_rec)\nbike_wflow\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> ══ Workflow ════════════════════════════════════════════════════════════════════\n#> Preprocessor: Recipe\n#> Model: logistic_reg()\n#> \n#> ── Preprocessor ────────────────────────────────────────────────────────────────\n#> 2 Recipe Steps\n#> \n#> • step_dummy()\n#> • step_zv()\n#> \n#> ── Model ───────────────────────────────────────────────────────────────────────\n#> Logistic Regression Model Specification (classification)\n#> \n#> Computational engine: glm\n```\n\n\n:::\n\n```{.r .cell-code}\nbike_fit <- \n  bike_wflow %>% \n  fit(data = train_data)\nbike_fit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> ══ Workflow [trained] ══════════════════════════════════════════════════════════\n#> Preprocessor: Recipe\n#> Model: logistic_reg()\n#> \n#> ── Preprocessor ────────────────────────────────────────────────────────────────\n#> 2 Recipe Steps\n#> \n#> • step_dummy()\n#> • step_zv()\n#> \n#> ── Model ───────────────────────────────────────────────────────────────────────\n#> \n#> Call:  stats::glm(formula = ..y ~ ., family = stats::binomial, data = data)\n#> \n#> Coefficients:\n#>                (Intercept)                          id  \n#>                 -21.783288                    0.180977  \n#>                     weight                       price  \n#>                  -2.001208                    0.002271  \n#>           shimano_dura_ace             shimano_ultegra  \n#>                  -6.297171                    2.151353  \n#>                shimano_105              shimano_tiagra  \n#>                   2.151008                  -16.625225  \n#>              shimano_deore                 shimano_slx  \n#>                   3.521455                  -38.313254  \n#>                shimano_grx                  Shimano_xt  \n#>                  -2.116947                   -0.034319  \n#>              Shimano_saint                    SRAM_red  \n#>                  64.366935                    7.389421  \n#>                 SRAM_force                  SRAM_rival  \n#>                  15.150271                    5.815513  \n#>                  SRAM_apex                    SRAM_xx1  \n#>                 -17.492212                  -39.906028  \n#>                   SRAM_x01                     SRAM_gx  \n#>                  15.344248                   -0.061026  \n#>                    SRAM_nx                     SRAM_sx  \n#>                 -35.940968                    2.085379  \n#>         Campagnolo_potenza     Campagnolo_super_record  \n#>                  20.257792                  -12.422863  \n#>              shimano_nexus              shimano_alfine  \n#>                  -0.849885                   -2.403389  \n#>          category_1_Gravel    category_1_Hybrid...City  \n#>                  64.897635                  -20.222378  \n#>        category_1_Mountain             category_1_Road  \n#>                  32.365891                   42.835462  \n#>        category_2_All.Road             category_2_City  \n#>                 -14.477164                   13.590390  \n#>   category_2_Cross.Country       category_2_Cyclocross  \n#>                  37.714018                   -0.433347  \n#>       category_2_Dirt.Jump         category_2_Downhill  \n#>                 -45.175281                  -58.162628  \n#>          category_2_E.City        category_2_E.Fitness  \n#>                  42.182330                  -16.335258  \n#>        category_2_E.Gravel       category_2_E.Mountain  \n#>                  49.784360                   47.133353  \n#>          category_2_E.Road       category_2_E.Trekking  \n#>                  17.904276                          NA  \n#>       category_2_Endurance           category_2_Enduro  \n#>                 -15.322716                  -21.516471  \n#>       category_2_Fat.Bikes             category_2_Race  \n#>                  55.798665                    5.065982  \n#> \n#> ...\n#> and 36 more lines.\n```\n\n\n:::\n\n```{.r .cell-code}\nbike_fit %>% \n  pull_workflow_fit() %>% \n  tidy()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"-21.783287752\",\"3\":\"1.949237e+04\",\"4\":\"-1.117529e-03\",\"5\":\"0.9991083\"},{\"1\":\"id\",\"2\":\"0.180977235\",\"3\":\"1.449457e-01\",\"4\":\"1.248587e+00\",\"5\":\"0.2118163\"},{\"1\":\"weight\",\"2\":\"-2.001207582\",\"3\":\"1.851101e+00\",\"4\":\"-1.081091e+00\",\"5\":\"0.2796568\"},{\"1\":\"price\",\"2\":\"0.002270815\",\"3\":\"1.428972e-03\",\"4\":\"1.589125e+00\",\"5\":\"0.1120322\"},{\"1\":\"shimano_dura_ace\",\"2\":\"-6.297170501\",\"3\":\"6.055985e+04\",\"4\":\"-1.039826e-04\",\"5\":\"0.9999170\"},{\"1\":\"shimano_ultegra\",\"2\":\"2.151353214\",\"3\":\"5.670672e+04\",\"4\":\"3.793824e-05\",\"5\":\"0.9999697\"},{\"1\":\"shimano_105\",\"2\":\"2.151007597\",\"3\":\"5.670672e+04\",\"4\":\"3.793215e-05\",\"5\":\"0.9999697\"},{\"1\":\"shimano_tiagra\",\"2\":\"-16.625224605\",\"3\":\"6.301218e+04\",\"4\":\"-2.638414e-04\",\"5\":\"0.9997895\"},{\"1\":\"shimano_deore\",\"2\":\"3.521454954\",\"3\":\"2.682884e+04\",\"4\":\"1.312563e-04\",\"5\":\"0.9998953\"},{\"1\":\"shimano_slx\",\"2\":\"-38.313253946\",\"3\":\"2.554237e+04\",\"4\":\"-1.499988e-03\",\"5\":\"0.9988032\"},{\"1\":\"shimano_grx\",\"2\":\"-2.116947126\",\"3\":\"4.960108e+04\",\"4\":\"-4.267946e-05\",\"5\":\"0.9999659\"},{\"1\":\"Shimano_xt\",\"2\":\"-0.034319121\",\"3\":\"2.877738e+04\",\"4\":\"-1.192573e-06\",\"5\":\"0.9999990\"},{\"1\":\"Shimano_saint\",\"2\":\"64.366935059\",\"3\":\"5.646681e+04\",\"4\":\"1.139907e-03\",\"5\":\"0.9990905\"},{\"1\":\"SRAM_red\",\"2\":\"7.389420829\",\"3\":\"5.858737e+04\",\"4\":\"1.261265e-04\",\"5\":\"0.9998994\"},{\"1\":\"SRAM_force\",\"2\":\"15.150271093\",\"3\":\"5.516547e+04\",\"4\":\"2.746332e-04\",\"5\":\"0.9997809\"},{\"1\":\"SRAM_rival\",\"2\":\"5.815512825\",\"3\":\"7.606309e+04\",\"4\":\"7.645644e-05\",\"5\":\"0.9999390\"},{\"1\":\"SRAM_apex\",\"2\":\"-17.492211632\",\"3\":\"7.442123e+04\",\"4\":\"-2.350433e-04\",\"5\":\"0.9998125\"},{\"1\":\"SRAM_xx1\",\"2\":\"-39.906027783\",\"3\":\"2.678717e+04\",\"4\":\"-1.489744e-03\",\"5\":\"0.9988114\"},{\"1\":\"SRAM_x01\",\"2\":\"15.344247889\",\"3\":\"1.172172e+04\",\"4\":\"1.309044e-03\",\"5\":\"0.9989555\"},{\"1\":\"SRAM_gx\",\"2\":\"-0.061025703\",\"3\":\"1.872046e+00\",\"4\":\"-3.259840e-02\",\"5\":\"0.9739948\"},{\"1\":\"SRAM_nx\",\"2\":\"-35.940968197\",\"3\":\"1.272039e+04\",\"4\":\"-2.825461e-03\",\"5\":\"0.9977456\"},{\"1\":\"SRAM_sx\",\"2\":\"2.085379494\",\"3\":\"3.907674e+04\",\"4\":\"5.336627e-05\",\"5\":\"0.9999574\"},{\"1\":\"Campagnolo_potenza\",\"2\":\"20.257792081\",\"3\":\"7.442123e+04\",\"4\":\"2.722045e-04\",\"5\":\"0.9997828\"},{\"1\":\"Campagnolo_super_record\",\"2\":\"-12.422863448\",\"3\":\"7.499136e+04\",\"4\":\"-1.656573e-04\",\"5\":\"0.9998678\"},{\"1\":\"shimano_nexus\",\"2\":\"-0.849885108\",\"3\":\"4.257400e+04\",\"4\":\"-1.996254e-05\",\"5\":\"0.9999841\"},{\"1\":\"shimano_alfine\",\"2\":\"-2.403389006\",\"3\":\"4.207948e+04\",\"4\":\"-5.711546e-05\",\"5\":\"0.9999544\"},{\"1\":\"category_1_Gravel\",\"2\":\"64.897635478\",\"3\":\"6.630506e+04\",\"4\":\"9.787735e-04\",\"5\":\"0.9992191\"},{\"1\":\"category_1_Hybrid...City\",\"2\":\"-20.222378033\",\"3\":\"2.828254e+04\",\"4\":\"-7.150127e-04\",\"5\":\"0.9994295\"},{\"1\":\"category_1_Mountain\",\"2\":\"32.365891107\",\"3\":\"2.108072e+04\",\"4\":\"1.535331e-03\",\"5\":\"0.9987750\"},{\"1\":\"category_1_Road\",\"2\":\"42.835462082\",\"3\":\"6.133181e+04\",\"4\":\"6.984216e-04\",\"5\":\"0.9994427\"},{\"1\":\"category_2_All.Road\",\"2\":\"-14.477164250\",\"3\":\"4.819614e+04\",\"4\":\"-3.003802e-04\",\"5\":\"0.9997603\"},{\"1\":\"category_2_City\",\"2\":\"13.590389527\",\"3\":\"6.424963e+04\",\"4\":\"2.115248e-04\",\"5\":\"0.9998312\"},{\"1\":\"category_2_Cross.Country\",\"2\":\"37.714018317\",\"3\":\"1.965140e+04\",\"4\":\"1.919152e-03\",\"5\":\"0.9984687\"},{\"1\":\"category_2_Cyclocross\",\"2\":\"-0.433346692\",\"3\":\"2.032393e+04\",\"4\":\"-2.132199e-05\",\"5\":\"0.9999830\"},{\"1\":\"category_2_Dirt.Jump\",\"2\":\"-45.175280805\",\"3\":\"2.806643e+04\",\"4\":\"-1.609584e-03\",\"5\":\"0.9987157\"},{\"1\":\"category_2_Downhill\",\"2\":\"-58.162628135\",\"3\":\"3.049721e+04\",\"4\":\"-1.907146e-03\",\"5\":\"0.9984783\"},{\"1\":\"category_2_E.City\",\"2\":\"42.182330474\",\"3\":\"3.871603e+04\",\"4\":\"1.089532e-03\",\"5\":\"0.9991307\"},{\"1\":\"category_2_E.Fitness\",\"2\":\"-16.335257986\",\"3\":\"3.314654e+04\",\"4\":\"-4.928194e-04\",\"5\":\"0.9996068\"},{\"1\":\"category_2_E.Gravel\",\"2\":\"49.784360245\",\"3\":\"5.877255e+04\",\"4\":\"8.470682e-04\",\"5\":\"0.9993241\"},{\"1\":\"category_2_E.Mountain\",\"2\":\"47.133352501\",\"3\":\"3.139562e+04\",\"4\":\"1.501271e-03\",\"5\":\"0.9988022\"},{\"1\":\"category_2_E.Road\",\"2\":\"17.904276057\",\"3\":\"7.185461e+04\",\"4\":\"2.491737e-04\",\"5\":\"0.9998012\"},{\"1\":\"category_2_E.Trekking\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_2_Endurance\",\"2\":\"-15.322715798\",\"3\":\"1.288367e+04\",\"4\":\"-1.189313e-03\",\"5\":\"0.9990511\"},{\"1\":\"category_2_Enduro\",\"2\":\"-21.516470617\",\"3\":\"8.027912e+03\",\"4\":\"-2.680208e-03\",\"5\":\"0.9978615\"},{\"1\":\"category_2_Fat.Bikes\",\"2\":\"55.798665430\",\"3\":\"4.919583e+04\",\"4\":\"1.134215e-03\",\"5\":\"0.9990950\"},{\"1\":\"category_2_Race\",\"2\":\"5.065981538\",\"3\":\"2.219126e+04\",\"4\":\"2.282872e-04\",\"5\":\"0.9998179\"},{\"1\":\"category_2_Touring\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_2_Trail\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_2_Triathlon.Bike\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Commuter\",\"2\":\"-12.049620121\",\"3\":\"6.306657e+04\",\"4\":\"-1.910619e-04\",\"5\":\"0.9998476\"},{\"1\":\"category_3_Commuter.ON\",\"2\":\"-49.759182306\",\"3\":\"4.718441e+04\",\"4\":\"-1.054568e-03\",\"5\":\"0.9991586\"},{\"1\":\"category_3_Dude\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Endurace\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Endurace.ON\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Exceed\",\"2\":\"11.757968798\",\"3\":\"1.996098e+04\",\"4\":\"5.890477e-04\",\"5\":\"0.9995300\"},{\"1\":\"category_3_Grail\",\"2\":\"-32.583585826\",\"3\":\"9.380590e+04\",\"4\":\"-3.473512e-04\",\"5\":\"0.9997229\"},{\"1\":\"category_3_Grail.ON\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Grand.Canyon\",\"2\":\"-32.275848071\",\"3\":\"2.107572e+04\",\"4\":\"-1.531424e-03\",\"5\":\"0.9987781\"},{\"1\":\"category_3_Grand.Canyon.ON\",\"2\":\"-37.539641771\",\"3\":\"4.448717e+04\",\"4\":\"-8.438307e-04\",\"5\":\"0.9993267\"},{\"1\":\"category_3_Inflite\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Lux\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Neuron\",\"2\":\"-15.474658966\",\"3\":\"8.027912e+03\",\"4\":\"-1.927607e-03\",\"5\":\"0.9984620\"},{\"1\":\"category_3_Neuron.ON\",\"2\":\"-38.162821385\",\"3\":\"5.411658e+04\",\"4\":\"-7.051965e-04\",\"5\":\"0.9994373\"},{\"1\":\"category_3_Pathlite\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Pathlite.ON\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Precede.ON\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Roadlite\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Roadlite.ON\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Sender\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Spectral\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Spectral.ON\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Speedmax\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Stitched\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Strive\",\"2\":\"-5.713487607\",\"3\":\"5.125428e+00\",\"4\":\"-1.114734e+00\",\"5\":\"0.2649646\"},{\"1\":\"category_3_Torque\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Ultimate\",\"2\":\"-10.158548713\",\"3\":\"2.177342e+04\",\"4\":\"-4.665573e-04\",\"5\":\"0.9996277\"},{\"1\":\"gender_unisex\",\"2\":\"1.207463403\",\"3\":\"1.305790e+00\",\"4\":\"9.246993e-01\",\"5\":\"0.3551223\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nbike_pred <- \n  predict(bike_fit, test_data, type=\"prob\") %>% \n  bind_cols(test_data %>% select(frame_material, category_2)) \nbike_pred %>% \n  roc_curve(truth = frame_material, .pred_aluminium) %>% \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](02_supervised_ml_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbike_pred %>% \n  roc_curve(truth = frame_material, .pred_carbon) %>% \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](02_supervised_ml_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n```{.r .cell-code}\nbike_pred\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\".pred_aluminium\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\".pred_carbon\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"frame_material\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"category_2\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1.618661e-11\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Race\"},{\"1\":\"1.046562e-10\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Race\"},{\"1\":\"9.340525e-01\",\"2\":\"6.594754e-02\",\"3\":\"aluminium\",\"4\":\"Endurance\"},{\"1\":\"1.000000e+00\",\"2\":\"5.079421e-10\",\"3\":\"aluminium\",\"4\":\"Endurance\"},{\"1\":\"3.697790e-03\",\"2\":\"9.963022e-01\",\"3\":\"carbon\",\"4\":\"Endurance\"},{\"1\":\"2.994847e-01\",\"2\":\"7.005153e-01\",\"3\":\"carbon\",\"4\":\"Endurance\"},{\"1\":\"1.519000e-01\",\"2\":\"8.481000e-01\",\"3\":\"carbon\",\"4\":\"Endurance\"},{\"1\":\"6.750805e-03\",\"2\":\"9.932492e-01\",\"3\":\"carbon\",\"4\":\"Endurance\"},{\"1\":\"9.414916e-01\",\"2\":\"5.850842e-02\",\"3\":\"aluminium\",\"4\":\"Cyclocross\"},{\"1\":\"2.901135e-11\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Triathlon Bike\"},{\"1\":\"2.355828e-10\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Triathlon Bike\"},{\"1\":\"6.278134e-11\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Triathlon Bike\"},{\"1\":\"5.061539e-10\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Triathlon Bike\"},{\"1\":\"1.876277e-13\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Triathlon Bike\"},{\"1\":\"6.948142e-10\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Triathlon Bike\"},{\"1\":\"5.005996e-12\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Race\"},{\"1\":\"4.673757e-09\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Race\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Fat Bikes\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Cross-Country\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Cross-Country\"},{\"1\":\"8.673844e-01\",\"2\":\"1.326156e-01\",\"3\":\"aluminium\",\"4\":\"All-Road\"},{\"1\":\"4.303780e-11\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"E-Gravel\"},{\"1\":\"8.401604e-01\",\"2\":\"1.598396e-01\",\"3\":\"aluminium\",\"4\":\"All-Road\"},{\"1\":\"1.000000e+00\",\"2\":\"8.812383e-12\",\"3\":\"aluminium\",\"4\":\"Trail\"},{\"1\":\"4.958868e-09\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Cross-Country\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Cross-Country\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Cross-Country\"},{\"1\":\"2.853894e-09\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Trail\"},{\"1\":\"9.847631e-01\",\"2\":\"1.523686e-02\",\"3\":\"aluminium\",\"4\":\"Trail\"},{\"1\":\"3.631590e-01\",\"2\":\"6.368410e-01\",\"3\":\"aluminium\",\"4\":\"Trail\"},{\"1\":\"5.396433e-01\",\"2\":\"4.603567e-01\",\"3\":\"aluminium\",\"4\":\"Trail\"},{\"1\":\"1.000000e+00\",\"2\":\"2.576529e-09\",\"3\":\"aluminium\",\"4\":\"E-Mountain\"},{\"1\":\"1.000000e+00\",\"2\":\"3.731098e-10\",\"3\":\"aluminium\",\"4\":\"E-Mountain\"},{\"1\":\"1.000000e+00\",\"2\":\"1.540586e-10\",\"3\":\"aluminium\",\"4\":\"E-Mountain\"},{\"1\":\"1.574629e-12\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Trail\"},{\"1\":\"1.366984e-11\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"E-Mountain\"},{\"1\":\"5.764801e-07\",\"2\":\"9.999994e-01\",\"3\":\"carbon\",\"4\":\"Enduro\"},{\"1\":\"9.983323e-01\",\"2\":\"1.667655e-03\",\"3\":\"carbon\",\"4\":\"Enduro\"},{\"1\":\"5.579746e-01\",\"2\":\"4.420254e-01\",\"3\":\"aluminium\",\"4\":\"Enduro\"},{\"1\":\"1.000000e+00\",\"2\":\"1.137464e-13\",\"3\":\"aluminium\",\"4\":\"E-Trekking\"},{\"1\":\"3.817380e-11\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"E-City\"},{\"1\":\"1.172884e-11\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"E-City\"},{\"1\":\"1.000000e+00\",\"2\":\"5.283830e-11\",\"3\":\"aluminium\",\"4\":\"City\"},{\"1\":\"1.000000e+00\",\"2\":\"2.731072e-12\",\"3\":\"aluminium\",\"4\":\"Touring\"},{\"1\":\"1.000000e+00\",\"2\":\"4.826143e-11\",\"3\":\"aluminium\",\"4\":\"City\"},{\"1\":\"5.308778e-01\",\"2\":\"4.691222e-01\",\"3\":\"aluminium\",\"4\":\"City\"},{\"1\":\"9.766563e-01\",\"2\":\"2.334371e-02\",\"3\":\"carbon\",\"4\":\"City\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nroc_al <- bike_pred %>% \n  roc_auc(truth = frame_material, .pred_aluminium)\nroc_al\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\".metric\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\".estimator\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\".estimate\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"roc_auc\",\"2\":\"binary\",\"3\":\"0.967433\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nroc_car <- bike_pred %>% \n  roc_auc(truth = frame_material, .pred_carbon)\nroc_car\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\".metric\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\".estimator\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\".estimate\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"roc_auc\",\"2\":\"binary\",\"3\":\"0.03256705\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Evaluation\nmodel_01_linear_lm_simple <- linear_reg(mode = \"regression\") %>%\n  set_engine(\"lm\") %>%\n  fit(price ~ category_2 + frame_material, data = train_data)\nmodel_01_linear_lm_simple\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> parsnip model object\n#> \n#> \n#> Call:\n#> stats::lm(formula = price ~ category_2 + frame_material, data = data)\n#> \n#> Coefficients:\n#>              (Intercept)        category_2All-Road            category_2City  \n#>                   2260.5                    -517.5                   -1390.7  \n#>  category_2Cross-Country      category_2Cyclocross       category_2Dirt Jump  \n#>                    123.9                    -533.6                    -994.9  \n#>       category_2Downhill          category_2E-City       category_2E-Fitness  \n#>                   1400.6                     821.7                     781.8  \n#>       category_2E-Gravel      category_2E-Mountain          category_2E-Road  \n#>                   1351.7                     772.7                     658.5  \n#>     category_2E-Trekking       category_2Endurance          category_2Enduro  \n#>                    806.8                    -579.6                     716.0  \n#>      category_2Fat Bikes            category_2Race         category_2Touring  \n#>                  -1705.0                     719.1                   -1074.4  \n#>          category_2Trail  category_2Triathlon Bike      frame_materialcarbon  \n#>                   -483.0                     530.0                    1583.5\n```\n\n\n:::\n\n```{.r .cell-code}\ntest_data <- test_data %>% filter(category_2 != \"Fat Bikes\")\nyards <- model_01_linear_lm_simple\nyards\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> parsnip model object\n#> \n#> \n#> Call:\n#> stats::lm(formula = price ~ category_2 + frame_material, data = data)\n#> \n#> Coefficients:\n#>              (Intercept)        category_2All-Road            category_2City  \n#>                   2260.5                    -517.5                   -1390.7  \n#>  category_2Cross-Country      category_2Cyclocross       category_2Dirt Jump  \n#>                    123.9                    -533.6                    -994.9  \n#>       category_2Downhill          category_2E-City       category_2E-Fitness  \n#>                   1400.6                     821.7                     781.8  \n#>       category_2E-Gravel      category_2E-Mountain          category_2E-Road  \n#>                   1351.7                     772.7                     658.5  \n#>     category_2E-Trekking       category_2Endurance          category_2Enduro  \n#>                    806.8                    -579.6                     716.0  \n#>      category_2Fat Bikes            category_2Race         category_2Touring  \n#>                  -1705.0                     719.1                   -1074.4  \n#>          category_2Trail  category_2Triathlon Bike      frame_materialcarbon  \n#>                   -483.0                     530.0                    1583.5\n```\n\n\n:::\n\n```{.r .cell-code}\ng1 <- bike_features_tbl %>% \n  mutate(category_2 = as.factor(category_2) %>% \n           fct_reorder(price)) %>% \n  \n  ggplot(aes(category_2, price)) +\n  geom_violin() +\n  geom_jitter(width = 0.1, alpha = 0.5, color = \"#00008B\") +\n  coord_flip() +\n  facet_wrap(~ frame_material) +\n  scale_y_continuous(labels = scales::dollar_format()) +\n  labs(\n    title = \"Unit Price for Each Model\",\n    y = \"\", x = \"Category 2\"\n  )\ng1\n```\n\n::: {.cell-output-display}\n![](02_supervised_ml_files/figure-html/unnamed-chunk-1-4.png){width=672}\n:::\n\n```{.r .cell-code}\nnew_race_alu <- tibble(\n  model = \"Exceed AL SL new\",\n  category_2 = \"Race\",\n  frame_material = \"aluminium\",\n  shimano_dura_ace = 0,\n  shimano_ultegra = 0,\n  shimano_105 = 0,\n  shimano_tiagra = 0,\n  Shimano_sora = 0,\n  shimano_deore = 0,\n  shimano_slx = 0,\n  shimano_grx = 0,\n  Shimano_xt = 1,\n  Shimano_xtr = 0,\n  Shimano_saint = 0,\n  SRAM_red = 0,\n  SRAM_force = 0,\n  SRAM_rival = 0,\n  SRAM_apex = 0,\n  SRAM_xx1 = 0,\n  SRAM_x01 = 0,\n  SRAM_gx = 0,\n  SRAM_nx = 0,\n  SRAM_sx = 0,\n  Campagnolo_potenza = 0,\n  Campagnolo_super_record = 0,\n  shimano_nexus = 0,\n  shimano_alfine = 0\n) \nnew_race_alu\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"model\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"category_2\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"frame_material\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"shimano_dura_ace\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_ultegra\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_105\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_tiagra\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_sora\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_deore\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_slx\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_grx\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_xt\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_xtr\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_saint\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_red\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_force\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_rival\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_apex\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_xx1\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_x01\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_gx\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_nx\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_sx\"],\"name\":[23],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Campagnolo_potenza\"],\"name\":[24],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Campagnolo_super_record\"],\"name\":[25],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_nexus\"],\"name\":[26],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_alfine\"],\"name\":[27],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Exceed AL SL new\",\"2\":\"Race\",\"3\":\"aluminium\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\npredict(model_01_linear_lm_simple, new_data = new_race_alu)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\".pred\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"2979.683\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nmodels_tbl <- tibble(\n  model_id = str_c(\"Model 0\", 1:1),\n  model = list(\n    model_01_linear_lm_simple\n  )\n)\nmodels_tbl\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"model_id\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"model\"],\"name\":[2],\"type\":[\"list\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Model 01\",\"2\":\"<S3: _lm>\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\npredictions_new_race_alu_tbl <- models_tbl %>%\n  mutate(predictions = map(model, predict, new_data = new_race_alu)) %>%\n  unnest(predictions) %>%\n  mutate(category_2 = \"Race\") %>%\n  left_join(new_race_alu, by = \"category_2\")\npredictions_new_race_alu_tbl\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"model_id\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"model.x\"],\"name\":[2],\"type\":[\"list\"],\"align\":[\"right\"]},{\"label\":[\".pred\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"category_2\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"model.y\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"frame_material\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"shimano_dura_ace\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_ultegra\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_105\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_tiagra\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_sora\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_deore\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_slx\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_grx\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_xt\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_xtr\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_saint\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_red\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_force\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_rival\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_apex\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_xx1\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_x01\"],\"name\":[23],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_gx\"],\"name\":[24],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_nx\"],\"name\":[25],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_sx\"],\"name\":[26],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Campagnolo_potenza\"],\"name\":[27],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Campagnolo_super_record\"],\"name\":[28],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_nexus\"],\"name\":[29],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_alfine\"],\"name\":[30],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Model 01\",\"2\":\"<S3: _lm>\",\"3\":\"2979.683\",\"4\":\"Race\",\"5\":\"Exceed AL SL new\",\"6\":\"aluminium\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ng2 <- g1 +\n  geom_point(aes(y = .pred), color = \"red\", alpha = 0.5,\n             data = predictions_new_race_alu_tbl) +\n  ggrepel::geom_text_repel(aes(label = model_id, y = .pred),\n                           size = 3,\n                           data = predictions_new_race_alu_tbl)\ng2\n```\n\n::: {.cell-output-display}\n![](02_supervised_ml_files/figure-html/unnamed-chunk-1-5.png){width=672}\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}